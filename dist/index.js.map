{"version":3,"file":"index.js","sources":["../src/components/LinkPreview.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport styles from './LinkPreview.css'\n\nconst isValidUrlProp = (props, propName, componentName) => {\n  if (!props) {\n    throw Error(`Missing required 'url' prop.`)\n  }\n  if (!isValidUrl(props[propName])) {\n    return new Error(\n      `Invalid prop '${propName}' passed to '${componentName}'. Expected a valid url.`\n    )\n  }\n}\n\nconst isValidUrl = (url) => {\n  const regex = /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/\n  const validUrl = regex.test(url)\n  return validUrl\n}\n\nfunction LinkPreview(props) {\n  const [loading, setLoading] = useState(true)\n  const [preview, setPreviewData] = useState({})\n  const [isUrlValid, setUrlValidation] = useState(false)\n\n  const {\n    url,\n    width,\n    maxWidth,\n    marginTop,\n    marginBottom,\n    marginRight,\n    marginLeft,\n    onClick,\n    render\n  } = props\n\n  const api = 'https://lpdg.herokuapp.com/parse/link'\n\n  const style = {\n    width,\n    maxWidth,\n    marginTop,\n    marginBottom,\n    marginRight,\n    marginLeft\n  }\n\n  useEffect(() => {\n    async function fetchData() {\n      const fetch = window.fetch\n      if (isValidUrl(url)) {\n        setUrlValidation(true)\n      } else {\n        return {}\n      }\n      setLoading(true)\n      const response = await fetch(api, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ url })\n      })\n      const data = await response.json()\n      setPreviewData(data)\n      setLoading(false)\n    }\n    fetchData()\n  }, [url])\n\n  if (!isUrlValid) {\n    console.error(\n      'LinkPreview Error: You need to provide url in props to render the component'\n    )\n    return null\n  }\n\n  // If the user wants to use its own element structure with the fetched data\n  if (render) {\n    return render({\n      loading: loading,\n      preview: preview\n    })\n  } else if (loading) {\n    return (\n      <div>\n        <div className={styles['link-preview-section']} style={style}>\n          <div className={styles['link-description']}>\n            <div className={styles.domain}>\n              <span\n                className={\n                  (styles['link-url-loader'], styles['animated-background'])\n                }\n              >\n                facebook.com\n              </span>\n            </div>\n            <div className={styles['link-data-loader']}>\n              <div className={(styles.p1, styles['animated-background'])}>\n                Shashank Shekhar\n              </div>\n              <div className={(styles.p2, styles['animated-background'])}>\n                This is some description\n              </div>\n            </div>\n          </div>\n          <div className={styles['link-image-loader']}>\n            <div className={styles.img} />\n          </div>\n        </div>\n      </div>\n    )\n  } else {\n    return (\n      <div>\n        <div\n          className={styles['link-preview-section']}\n          style={style}\n          onClick={onClick}\n        >\n          <div className={styles['link-description']}>\n            <div className={styles.domain}>\n              <span className={styles['link-url']}>{preview.domain}</span>\n            </div>\n            <div className={styles['link-data']}>\n              <div className={styles['link-title']}>{preview.title}</div>\n              <div className={styles['link-description']}>\n                {preview.description}\n              </div>\n            </div>\n          </div>\n          <div className={styles['link-image']}>\n            {preview.img && <img src={preview.img} alt={preview.description} />}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nLinkPreview.defaultProps = {\n  onClick: () => {},\n  width: '90%',\n  maxWidth: '700px',\n  marginTop: '18px',\n  marginBottom: '18px',\n  marginRight: 'auto',\n  marginLeft: 'auto'\n}\n\nLinkPreview.propTyps = {\n  url: isValidUrlProp,\n  onClick: PropTypes.func,\n  render: PropTypes.func\n}\n\nexport default LinkPreview\n"],"names":["isValidUrlProp","props","propName","componentName","Error","isValidUrl","url","regex","validUrl","test","LinkPreview","useState","loading","setLoading","preview","setPreviewData","isUrlValid","setUrlValidation","width","maxWidth","marginTop","marginBottom","marginRight","marginLeft","onClick","render","api","style","useEffect","fetchData","fetch","window","method","headers","Accept","body","JSON","stringify","response","json","data","console","error","React","styles","domain","img","title","description","defaultProps","propTyps","PropTypes","func"],"mappings":"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"}